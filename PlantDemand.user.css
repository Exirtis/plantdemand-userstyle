/* ==UserStyle==
@name        PlantDemand UI Tweaks â€” UserCSS (global + per-section controls)
@namespace   https://example.com/chad
@version     1.0.9
@description Defaults with per-section overrides (fonts, sizes, colors) for the Schedule (calendar) on plantdemand.com
@author      Chad M.
@license     MIT
@preprocessor stylus

@homepageURL  https://github.com/exirtis/plantdemand-userstyle
@supportURL   https://github.com/exirtis/plantdemand-userstyle/issues
@downloadURL  https://raw.githubusercontent.com/exirtis/plantdemand-userstyle/main/PlantDemand.user.css
@updateURL    https://raw.githubusercontent.com/exirtis/plantdemand-userstyle/main/PlantDemand.user.css

@var select   fontPreset         "ğŸŒ GLOBAL font â€”â–º choose" { "System UI": "preset-system", "Monospace*": "preset-mono", "Inter": "preset-inter", "Segoe UI": "preset-segoe", "Roboto": "preset-roboto", "Arial": "preset-arial", "Open Sans": "preset-openSans", "Custom (use text field below)": "preset-custom" }
@var text     fontCustom         "Custom GLOBAL font list (if ''Custom'' is chosen)" "'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif"

@var checkbox sectionSpacer01         " â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€" 0

@var select   customerFontMode   "ğŸ­ CUSTOMER: font source (Global, Override, or Custom)" { "use Global": "global", "use Override*": "preset", "use Custom": "custom" }
@var select   customerFontPreset "Font preset for CUSTOMER  (when mode = ''Override'')" { "Open Sans*": "preset-openSans", "System UI": "preset-system", "Monospace": "preset-mono", "Inter": "preset-inter", "Segoe UI": "preset-segoe", "Roboto": "preset-roboto", "Arial": "preset-arial", "Custom (use text field below)": "preset-custom" }
@var text     customerFontCustom "Custom CUSTOMER font (when mode = ''Custom'')" "'Open Sans', system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif"
@var number   customerFontSize   "Font-size for CUSTOMER" [0.8125, 0, 3, 0.0001, "rem"]
@var checkbox customerUseBg      "Enable custom CUSTOMER background (bg) color" 1
@var color    customerBgColor    "CUSTOMER background (bg) Color" #fbfbdc
@var number   customerBgAlpha    "CUSTOMER bg color Opacity (0..1)" [1, 0, 1, 0.01]
@var checkbox customerUseColor   "Enable custom CUSTOMER text color" 0
@var color    customerColor      "CUSTOMER text color" #2b2b2b

@var checkbox sectionSpacer02         " â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”" 0

@var select   productFontMode    "ğŸ“¦ PRODUCT: font source (Global, Override, or Custom)" { "use Global*": "global", "use Override": "preset", "use Custom": "custom" }
@var select   productFontPreset  "Font preset for PRODUCT  (when mode = ''Override'')" { "Monospace*": "preset-mono", "System UI": "preset-system", "Inter": "preset-inter", "Segoe UI": "preset-segoe", "Roboto": "preset-roboto", "Arial": "preset-arial", "Open Sans": "preset-openSans", "Custom (use text field below)": "preset-custom" }
@var text     productFontCustom  "Custom PRODUCT font (when mode = ''Custom'')" "ui-monospace, 'SFMono-Regular', Menlo, Consolas, 'Liberation Mono', monospace"
@var number   productFontSize    "Font-size for PRODUCT" [0.75, 0, 3, 0.01, "rem"]
@var checkbox productUseBg       "Enable custom PRODUCT background (bg) color" 0
@var color    productBgColor     "PRODUCT background (bg) Color" #fbfbdc
@var number   productBgAlpha     "PRODUCT bg color Opacity (0..1)" [1, 0, 1, 0.01]
@var checkbox productUseColor    "Enable custom PRODUCT text color" 0
@var color    productColor       "PRODUCT text color" #743400

@var checkbox sectionSpacer03         " â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”" 0

@var select   orderFontMode      "ğŸ½ï¸ ORDER #: font source (Global, Override, or Custom)" { "use Global*": "global", "use Override": "preset", "use Custom": "custom" }
@var select   orderFontPreset    "Font preset for ORDER Number  (when mode = ''Override'')" { "Monospace*": "preset-mono", "System UI": "preset-system", "Inter": "preset-inter", "Segoe UI": "preset-segoe", "Roboto": "preset-roboto", "Arial": "preset-arial", "Open Sans": "preset-openSans", "Custom (use text field below)": "preset-custom" }
@var text     orderFontCustom    "Custom ORDER # font (when mode = ''Custom'')" "ui-monospace, 'SFMono-Regular', Menlo, Consolas, 'Liberation Mono', monospace"
@var number   orderFontSize      "Font-size for ORDER" [0.875, 0, 3, 0.001, "rem"]
@var checkbox orderUseBg         "Enable custom ORDER # background (bg) color" 0
@var color    orderBgColor       "ORDER # background (bg) Color" #fbfbdc
@var number   orderBgAlpha       "ORDER # bg color Opacity (0..1)" [1, 0, 1, 0.01]
@var checkbox orderUseColor      "Enable custom ORDER # text color" 1
@var color    orderColor         "ORDER # text color" #1a1ae6
@var checkbox orderBold          "Toggle bold for ORDER #: bold" 1

@var checkbox sectionSpacer04         " â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”" 0

@var select   poFontMode         "ğŸ”– PO NUMBER: font source (Global, Override, or Custom)" { "use Global*": "global", "use Override": "preset", "use Custom": "custom" }
@var select   poFontPreset       "Font preset for PO Number  (when mode = ''Override'')" { "Monospace*": "preset-mono", "System UI": "preset-system", "Inter": "preset-inter", "Segoe UI": "preset-segoe", "Roboto": "preset-roboto", "Arial": "preset-arial", "Open Sans": "preset-openSans", "Custom (use text field below)": "preset-custom" }
@var text     poFontCustom       "Custom PO Number font (when mode = ''Custom'')" "ui-monospace, 'SFMono-Regular', Menlo, Consolas, 'Liberation Mono', monospace"
@var number   poFontSize         "Font-size for PO NUMBER" [0.8125, 0, 3, 0.0001, "rem"]
@var checkbox poUseBg            "Enable custom PO # background (bg) color" 0
@var color    poBgColor          "PO # background (bg) Color" #fbfbdc
@var number   poBgAlpha          "PO # bg color Opacity (0..1)" [1, 0, 1, 0.01]
@var checkbox poUseColor         "Enable custom PO # text color" 1
@var color    poColor            "PO # text color" #008f0c

@var checkbox sectionSpacer05         " â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”" 0

@var select   expireFontMode     "ğŸ“… EXPIRE Date: font source (Global, Override, or Custom)" { "use Global*": "global", "use Override": "preset", "use Custom": "custom" }
@var select   expireFontPreset   "Font preset for EXPIRE Date  (when mode = ''Override'')" { "Monospace*": "preset-mono", "System UI": "preset-system", "Inter": "preset-inter", "Segoe UI": "preset-segoe", "Roboto": "preset-roboto", "Arial": "preset-arial", "Open Sans": "preset-openSans", "Custom (use text field below)": "preset-custom" }
@var text     expireFontCustom   "Custom EXPIRE font (when mode = ''Custom'')" "ui-monospace, 'SFMono-Regular', Menlo, Consolas, 'Liberation Mono', monospace"
@var number   expireFontSize     "Font-size for EXPIRE Date" [0.75, 0, 3, 0.01, "rem"]
@var checkbox expireUseBg        "Enable custom EXPIRE Date background (bg) color" 0
@var color    expireBgColor      "EXPIRE Date background (bg) Color" #fbfbdc
@var number   expireBgAlpha      "EXPIRE Date bg color Opacity (0..1)" [1, 0, 1, 0.01]
@var checkbox expireUseColor     "Enable custom EXPIRE Date text color" 1
@var color    expireColor        "EXPIRE Date text color" #aa0000

@var checkbox sectionSpacer06         " â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”" 0

@var select   loadFontMode       "â° LOAD TIME: font source (Global, Override, or Custom)" { "use Global*": "global", "use Override with preset": "preset", "use Custom": "custom" }
@var select   loadFontPreset     "Font preset for LOAD TIME  (when mode = ''Override'')" { "Monospace*": "preset-mono", "System UI": "preset-system", "Inter": "preset-inter", "Segoe UI": "preset-segoe", "Roboto": "preset-roboto", "Arial": "preset-arial", "Open Sans": "preset-openSans", "Custom (use text field below)": "preset-custom" }
@var text     loadFontCustom     "Custom LOAD TIME font (when mode = ''Custom'')" "ui-monospace, 'SFMono-Regular', Menlo, Consolas, 'Liberation Mono', monospace"
@var number   loadFontSize       "Font-size for LOAD TIME" [0.875, 0, 3, 0.001, "rem"]
@var checkbox loadUseBg          "Enable custom LOAD TIME background (bg) color" 0
@var color    loadBgColor        "LOAD TIME background (bg) Color" #fbfbdc
@var number   loadBgAlpha        "LOAD TIME bg color Opacity (0..1)" [1, 0, 1, 0.01]
@var checkbox loadUseColor       "Enable custom LOAD TIME text color" 0
@var color    loadColor          "LOAD TIME text color" #3b0077

@var checkbox sectionSpacer07         " â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" 0


@var checkbox useImportant "Append !important to declarations" 1
==/UserStyle== */

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Implementation
   - Helpers compute font stacks and per-section overrides.
   - Pill background uses rgba(color, alpha) (no color-mix()).
   - We branch on useImportant to add/remove !important cleanly.
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Implementation (coerce select/text idents to strings; robust font overrides)
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

/* Map preset keys to concrete font stacks */
stack(preset)
  if preset == 'preset-system'
    return 'system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif'
  else if preset == 'preset-mono'
    return 'ui-monospace, "SFMono-Regular", Menlo, Consolas, "Liberation Mono", monospace'
  else if preset == 'preset-inter'
    return '"Inter", system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif'
  else if preset == 'preset-segoe'
    return '"Segoe UI", SegoeUI, "Helvetica Neue", Arial, sans-serif'
  else if preset == 'preset-roboto'
    return 'Roboto, "Helvetica Neue", Arial, sans-serif'
  else if preset == 'preset-arial'
    return 'Arial, Helvetica, sans-serif'
  else if preset == 'preset-openSans'
    return '"Open Sans", system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif'
  else
    return ''  /* preset-custom or unknown */

/* â”€â”€ Coerce UserCSS vars to STRINGS by concatenation ('' + ident â†’ string) */
fontPresetS          = '' + fontPreset
fontCustomS          = '' + fontCustom

customerFontModeS    = '' + customerFontMode
customerFontPresetS  = '' + customerFontPreset
customerFontCustomS  = '' + customerFontCustom

productFontModeS     = '' + productFontMode
productFontPresetS   = '' + productFontPreset
productFontCustomS   = '' + productFontCustom

orderFontModeS       = '' + orderFontMode
orderFontPresetS     = '' + orderFontPreset
orderFontCustomS     = '' + orderFontCustom

poFontModeS          = '' + poFontMode
poFontPresetS        = '' + poFontPreset
poFontCustomS        = '' + poFontCustom

expireFontModeS      = '' + expireFontMode
expireFontPresetS    = '' + expireFontPreset
expireFontCustomS    = '' + expireFontCustom

loadFontModeS        = '' + loadFontMode
loadFontPresetS      = '' + loadFontPreset
loadFontCustomS      = '' + loadFontCustom

/* Resolve global & section font stacks using STRING values */
globalFont = fontPresetS == 'preset-custom' ? fontCustomS : stack(fontPresetS)

resolveFont(modeS, presetS, customS)
  if modeS == 'preset'
    s = stack(presetS)
    return s != '' ? s : customS
  else if modeS == 'custom'
    return customS
  else
    return globalFont  /* modeS == 'global' */

/* Precompute background with opacity, for selected elements */
customerBgComputed = rgba(customerBgColor, customerBgAlpha)
productBgComputed = rgba(productBgColor, productBgAlpha)
orderBgComputed = rgba(orderBgColor, orderBgAlpha)
poBgComputed = rgba(poBgColor, poBgAlpha)
expireBgComputed = rgba(expireBgColor, expireBgAlpha)
loadBgComputed = rgba(loadBgColor, loadBgAlpha)

/* Scope to plantdemand.com */
@-moz-document domain("plantdemand.com")

  /* ---------- Customer Titling / pill header ---------- */
  customerFont = resolveFont(customerFontModeS, customerFontPresetS, customerFontCustomS)

  if useImportant == 1
    div[data-testid="pill-customer"] div.pill__header__38Us8,
    div[data-testid="pill-customer"] div.pill__header__38Us8 *
      font-family unquote(customerFont) !important
    div[data-testid="pill-customer"] div.pill__header__38Us8
      font-size customerFontSize !important
      if customerUseBg == 1
        background-color customerBgComputed !important
      if customerUseColor == 1
        color customerColor !important
  else
    div[data-testid="pill-customer"] div.pill__header__38Us8,
    div[data-testid="pill-customer"] div.pill__header__38Us8 *
      font-family unquote(customerFont)
    div[data-testid="pill-customer"] div.pill__header__38Us8
      font-size customerFontSize
      if customerUseBg == 1
        background-color customerBgComputed
      if customerUseColor == 1
        color customerColor

  /* ---------- Product header ---------- */
  productFont = resolveFont(productFontModeS, productFontPresetS, productFontCustomS)

  if useImportant == 1
    div.order__header__RkIf1,
    div.order__header__RkIf1 *
      font-family unquote(productFont) !important
    div.order__header__RkIf1
      font-size productFontSize !important
      if productUseBg == 1
        background-color productBgComputed !important
      if productUseColor == 1
        color productColor !important
  else
    div.order__header__RkIf1,
    div.order__header__RkIf1 *
      font-family unquote(productFont)
    div.order__header__RkIf1
      font-size productFontSize
      if productUseBg == 1
        background-color productBgComputed
      if productUseColor == 1
        color productColor

  /* ---------- Order # ---------- */
  orderFont = resolveFont(orderFontModeS, orderFontPresetS, orderFontCustomS)

  if useImportant == 1
    .order__field__20xzI[data-field="Order Number"],
    .order__field__20xzI[data-field="Order Number"] *
      font-family unquote(orderFont) !important
    .order__field__20xzI[data-field="Order Number"]
      font-size orderFontSize !important
      font-weight (orderBold == 1 ? bold : normal) !important
      if orderUseBg == 1
        background-color orderBgComputed !important
      if orderUseColor == 1
        color orderColor !important
  else
    .order__field__20xzI[data-field="Order Number"],
    .order__field__20xzI[data-field="Order Number"] *
      font-family unquote(orderFont)
    .order__field__20xzI[data-field="Order Number"]
      font-size orderFontSize
      font-weight (orderBold == 1 ? bold : normal)
      if orderUseBg == 1
        background-color orderBgComputed
      if orderUseColor == 1
        color orderColor

  /* ---------- Purchase order # ---------- */
  poFont = resolveFont(poFontModeS, poFontPresetS, poFontCustomS)

  if useImportant == 1
    .order__field__20xzI[data-field="Purchase order #"],
    .order__field__20xzI[data-field="Purchase order #"] *
      font-family unquote(poFont) !important
    .order__field__20xzI[data-field="Purchase order #"]
      font-size poFontSize !important
      if poUseBg == 1
        background-color poBgComputed !important
      if poUseColor == 1
        color poColor !important
  else
    .order__field__20xzI[data-field="Purchase order #"],
    .order__field__20xzI[data-field="Purchase order #"] *
      font-family unquote(poFont)
    .order__field__20xzI[data-field="Purchase order #"]
      font-size poFontSize
      if poUseBg == 1
        background-color poBgComputed
      if poUseColor == 1
        color poColor

  /* ---------- Expire Date ---------- */
  expireFont = resolveFont(expireFontModeS, expireFontPresetS, expireFontCustomS)

  if useImportant == 1
    .order__field__20xzI[data-field="Expire Date"],
    .order__field__20xzI[data-field="Expire Date"] *
      font-family unquote(expireFont) !important
    .order__field__20xzI[data-field="Expire Date"]
      font-size expireFontSize !important
      if expireUseBg == 1
        background-color expireBgComputed !important
      if expireUseColor == 1
        color expireColor !important
  else
    .order__field__20xzI[data-field="Expire Date"],
    .order__field__20xzI[data-field="Expire Date"] *
      font-family unquote(expireFont)
    .order__field__20xzI[data-field="Expire Date"]
      font-size expireFontSize
      if expireUseBg == 1
        background-color expireBgComputed
      if expireUseColor == 1
        color expireColor

  /* ---------- Load Time (conditional element) ---------- */
  loadFont = resolveFont(loadFontModeS, loadFontPresetS, loadFontCustomS)

  if useImportant == 1
    .order__loadTime__2N6BS,
    .order__loadTime__2N6BS *
      font-family unquote(loadFont) !important
    .order__loadTime__2N6BS
      font-size loadFontSize !important
      if loadUseBg == 1
        background-color loadBgComputed !important
      if loadUseColor == 1
        color loadColor !important
  else
    .order__loadTime__2N6BS,
    .order__loadTime__2N6BS *
      font-family unquote(loadFont)
    .order__loadTime__2N6BS
      font-size loadFontSize
      if loadUseBg == 1
        background-color loadBgComputed
      if loadUseColor == 1

        color loadColor
